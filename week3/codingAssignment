-- All of the questions in this quiz refer to the open source Chinook Database


/* #1 Using a subquery, find the names of all the tracks for the album "Californication".*/
select Name from Tracks where AlbumId is (
select AlbumId from Albums where Title = 'Californication')


/* #2 Find the total number of invoices for each customer along with the customer's full name, city and email. */
select c.FirstName, c.LastName, c.City, c.Email, count(i.CustomerId) as numinv
from Customers c inner join Invoices i on c.CustomerId = i.CustomerId
group by c.CustomerId

-- Note: This one has to use group by in the end, otherwise it only shows one client's name.


/* #3 What is the song title of trackID 12 from the "For Those About to Rock We Salute You" album? Enter the answer below.*/ 
-- first try, the problem description is 'For Those About to Rock We Salute You'
-- But it's actually 'For Those About To Rock We Salute You' (case sensitive)
-- Use wildcards
select t.Name as TrackName, t.AlbumId, a.ArtistId, t.TrackId,a.Title
from Tracks t inner join Albums a on t.AlbumId = a.AlbumId
where a.Title like 'For%' and t.TrackId = 12


-- Final soln
select t.Name as TrackName, t.AlbumId, a.ArtistId, t.TrackId,a.Title
from Tracks t inner join Albums a on t.AlbumId = a.AlbumId
where a.Title = 'For Those About To Rock We Salute You' and t.TrackId = 12



-- Given the AlbumId of 'For Those About to Rock We Salute You' is 1, we can use
select t.Name as TrackName, t.AlbumId, a.ArtistId, t.TrackId,a.Title
from Tracks t inner join Albums a on t.AlbumId = a.AlbumId
where a.AlbumId = 1


/* #4 Retrieve a list with the managers last name, and the last name of the employees who report to him or her.*/
-- First, check the job types among the employees table
select Title
from Employees

+---------------------+
| Title               |
+---------------------+
| General Manager     |
| Sales Manager       |
| Sales Support Agent |
| Sales Support Agent |
| Sales Support Agent |
| IT Manager          |
| IT Staff            |
| IT Staff            |
+---------------------+

-- There are 3 managers: General Manager, IT Manager and Sales Manager

-- Use wildcards to retrieve Managers' name
select FirstName, LastName, Title, ReportsTo
from Employees
where Title like '%Manager'

+-----------+----------+-----------------+-----------+
| FirstName | LastName | Title           | ReportsTo |
+-----------+----------+-----------------+-----------+
| Andrew    | Adams    | General Manager |      None |
| Nancy     | Edwards  | Sales Manager   |         1 |
| Michael   | Mitchell | IT Manager      |         1 |
+-----------+----------+-----------------+-----------+








